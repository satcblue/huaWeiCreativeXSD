# 全局变量概述

更新时间: 2024-01-22 16:52

## 功能概述
全局变量是指在引擎中已经预置好的固定名字的变量，可供直接使用。全局变量为放置在项目VariableManager中的一系列全局变量，在整个项目的任意位置都能够调用获取最新的全局变量的值。使用`#`取数值，使用`@`取字符串。

## 应用场景
- 在一个人脸或者动物脸的图片上，引用`touch_x/y`来实现眼睛跟随手指的方向转动。
- 引用时间全局变量，控制壁纸的更换或者在日历上图片上显示时间。

## XML规范
```xml
<Var name="" expression="#screen_width" />
```

## 变量说明

### 触摸
| 参 数           | 注 释                                    |
|----------------|---------------------------------------|
| touch_x        | 当前触摸点的x坐标                        |
| touch_y        | 当前触摸点的y坐标                        |
| touch_begin_x  | 按下屏幕时的初始x坐标                    |
| touch_begin_y  | 按下屏幕时的初始y坐标                    |
| touch_begin_time | 触摸开始的时间，单位ms，是当前时间与协调世界时 1970 年 1 月 1 日午夜之间的时间差 |
| touch_pressure | 按屏幕的压力值【需要设备支持，和厂商适配】，该参数需要生效，必须在lockscreen标签下写入pressure="true" |

### 解锁
| 参 数        | 注 释                                 |
|-------------|------------------------------------|
| name.move_x | 解锁部件在x方向的偏移                  |
| name.move_y | 解锁部件在y方向的偏移                  |
| name.move_dist | 解锁部件移动的距离                    |
| name.state  | 解锁部件的状态：NORMAL_STATE（0）,PRESSED_STATE（1）,REACHED_STATE（2）,INVISIBLE_STATE（3） |

### 时间/日期
| 参 数              | 注 释                                  |
|-------------------|-------------------------------------|
| time              | 当前时间毫秒值                           |
| year              | 年                                    |
| month             | 月（取值范围是0~11，0表示一月，1表示二月，以此类推） |
| date              | 日                                    |
| day_of_week       | 星期（1表示星期日，2表示星期一，等等）        |
| hour              | 当前小时，显示24小时制                      |
| hour12            | 12小时制小时数，显示与系统时间制一致              |
| hour24            | 24小时制小时数，显示与系统时间制一致              |
| minute            | 分钟                                  |
| second            | 秒                                    |
| ishour12          | 字符串类型，是否是12小时制（true，false）       |
| lunarYear         | 农历年                                 |
| lunarMonth        | 农历月                                 |
| lunarDay          | 农历日                                 |
| time_sys          | 系统时间，时间格式为 yyyy-MM-dd hh:mm:ss:SSS |
| system.time.hour1 | 小时的第一位，例如09:00显示0，时间在12小时制12点显示1，24点显示0 |
| system.time.hour2 | 小时的第二位，例如09:00显示9，时间在12小时制12点显示2，24点显示0 |
| system.time.min1  | 分钟的第一位，例如09:30显示3               |
| system.time.min2  | 分钟的第二位，例如09:30显示0               |
| system.time.ampm  | ampm显示，根据不同的区域和语言显示不同的结果。该值当ishour12为true时才有值显示，为false时显示为空 |
| system.date       | 日期格式化显示，根据不同的区域和语言显示不同的格式和语言的日期 |

### 电量
| 参 数           | 类 型 | 注 释                                |
|----------------|------|-----------------------------------|
| battery_level  | 数值   | 当前电量，1~100                        |
| battery_state  | 数值   | 电池的状态：“Normal”(0)，“Charging”(1)，“BatteryLow”(2)，”BatteryFull“(3) |

### 系统深色模式
支持获取系统深色模式信息在桌面和桌面万象小组件中使用，不支持在锁屏使用。手机系统须为EMUI10及以上版本，系统深色模式全局变量方可生效。仅支持获取系统深色模式设置状态，并根据该状态进行显示效果的适配，不支持通过命令改变系统深色模式设置状态。

| 参 数     | 类 型 | 注 释                     |
|----------|------|------------------------|
| darkMode | 数值   | 当前模式：1 浅色模式 ，2 深色模式 ，0 不支持任何模式 |

### 音乐时长/进度
| 参数                | 类型 | 注释                                    |
|-------------------|----|---------------------------------------|
| musicTotalDuration | 数值 | 获取当前播放音乐的总时长，形式为分:秒，如 04:52       |
| musicPlayDuration  | 数值 | 获取当前音乐播放进度，形式为分:秒，如 02:30       |
| musicTotalSecond   | 数值 | 获取当前播放音乐的总时长，形式为秒，如 650        |
| musicPlaySecond    | 数值 | 获取当前音乐播放进度，形式为秒，如 180        |

### 屏幕宽高
| 参 数           | 类 型 | 注 释     |
|----------------|------|--------|
| screen_width   | 数值   | 屏幕宽度  |
| screen_height  | 数值   | 屏幕高度  |

### 图片宽高
| 参 数          | 类 型 | 注 释        |
|---------------|------|-----------|
| name.actual_w | 数值   | 图片实际宽度   |
| name.actual_h | 数值   | 图片实际高度   |

### 文本宽高
| 参 数           | 类 型 | 注 释                                                    |
|----------------|------|-------------------------------------------------------|
| name.text_width | 数值   | 文本的宽度，name为文本功能中指定的name，例如：`<Text name="a" text="hahaha" size="50"/>`，可通过`a.text_width`取得a文本的文本宽度 |
| name.text_height | 数值   | 文本的高度                                                |

### 其他
| 参 数             | 类 型 | 注 释                                                                           |
|------------------|------|------------------------------------------------------------------------------|
| sms_unread_count | 数值   | 未读短信数（*注：需系统调用接口synchronizeData传入数据，此变量才生效）                                 |
| call_missed_count | 数值   | 未接电话数（*注：需系统调用接口synchronizeData传入数据，此变量才生效）                                 |
| point_count      | 数值   | 积分常量                                                                          |
| steps_value      | 数值   | 步数 （*注：需系统调用接口synchronizeData传入数据，此变量才生效，EMUI10.1.0.160及以上支持该变量，其余该变量值为0） |
| music_active     | 数值   | 监听三方音乐是否在播放，1表示在播放，0表示暂停                                               |

### 组件
其中的name都为组件的名字。

| 参 数                     | 类 型 | 注 释            |
|--------------------------|------|---------------|
| name.visibility          | 数值   | 组件的可见性，1为可见 |
| name.actual_x/name.actual_y | 数值   | 元素实际x/y坐标   |
| name.actual_w/name.actual_h | 数值   | 元素实际高度与宽度  |

### 日历基本数据
| 参 数       | 类 型   | 注 释                                      |
|------------|------|-----------------------------------------|
| festival   | 数值   | [0~21] ，国家法定节假日具体映射关系如下表：                           |
| is_work_day | 布尔值  | true：国家法定工作日；false: 国家法定休息日。                 |

#### 国家法定节假日映射关系表
| 数值 | 节假日      |
|----|----------|
| 0  | 缺省值，非节假日 |
| 1  | 元旦       |
| 2  | 除夕       |
| 3  | 春节       |
| 4  | 元宵节      |
| 5  | 情人节      |
| 6  | 妇女节      |
| 7  | 愚人节      |
| 8  | 清明节      |
| 9  | 劳动节      |
| 10 | 母亲节      |
| 11 | 儿童节      |
| 12 | 父亲节      |
| 13 | 端午节      |
| 14 | 中秋节      |
| 15 | 国庆节      |

-----